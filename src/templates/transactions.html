{% extends "base.html" %}

{% block title %}Transacciones — Inventario {% endblock %}

{% block content %}
  <div class="card">
    <div style="display:flex;flex-direction:column;gap:12px;margin-bottom:12px;">
      <div>
        <h2 style="margin:0 0 6px 0;font-size:clamp(20px, 5vw, 28px);">Transacciones</h2>
        <div class="small">Historial de transacciones</div>
      </div>
      <div class="controls" style="display:grid;grid-template-columns:1fr 1fr;gap:8px;width:100%;">
        <a class="btn" href="{{ url_for('record_transaction') }}" style="text-align:center;display:flex;align-items:center;justify-content:center;min-height:44px;font-size:14px;">+ Trans.</a>
        <a class="btn secondary" href="{{ url_for('index') }}" style="text-align:center;display:flex;align-items:center;justify-content:center;min-height:44px;font-size:14px;">Volver</a>
      </div>
    </div>

    {% if transactions_list %}
      <div style="overflow-x:auto;-webkit-overflow-scrolling:touch;">
      <table style="width:100%;border-collapse:collapse;">
        <thead>
          <tr>
            <th style="text-align:left;padding:10px;border-bottom:2px solid #e2e8f0;font-size:clamp(12px,2vw,14px);">Código</th>
            <th style="text-align:left;padding:10px;border-bottom:2px solid #e2e8f0;font-size:clamp(12px,2vw,14px);">Producto</th>
            <th style="text-align:right;padding:10px;border-bottom:2px solid #e2e8f0;font-size:clamp(12px,2vw,14px);">Total</th>
            <th style="text-align:center;padding:10px;border-bottom:2px solid #e2e8f0;font-size:clamp(12px,2vw,14px);">Acc.</th>
          </tr>
        </thead>
        <tbody>
        {% for tx in transactions_list %}
          <tr style="border-bottom:1px solid #e2e8f0;">
            <td style="padding:10px;word-break:break-word;font-size:14px;">{{ tx.codigo }}</td>
            <td style="padding:10px;word-break:break-word;font-size:14px;">{{ tx.product }}</td>
            <td style="padding:10px;text-align:right;font-size:14px;font-weight:bold;">{{ "%.2f"|format(tx.total|float) }}</td>
            <td style="padding:10px;text-align:center;">
            <div class="actions" style="display:flex;gap:4px;justify-content:center;flex-wrap:wrap;">
              <a class="btn secondary" href="{{ url_for('edit_transaction', id=tx._id) }}" style="padding:6px 10px;font-size:12px;min-height:auto;">✎</a>
              <form method="post" action="{{ url_for('delete_transaction', id=tx._id) }}" style="display:inline;margin:0;">
                <button class="btn danger" type="submit" onclick="return confirm('¿Eliminar?')" style="padding:6px 10px;font-size:12px;min-height:auto;">✕</button>
              </form>
            </div>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
      </div>
    {% else %}
      <p class="muted">No hay transacciones registradas.</p>
    {% endif %}
  </div>
{% endblock %}